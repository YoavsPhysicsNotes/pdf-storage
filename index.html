<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8" />
  <title>Yoav's Physics PDFs</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 0 16px;
      direction: rtl;
      text-align: right;
    }
    h1 { margin-bottom: 0.5rem; }
    h2 { margin-top: 2rem; }
    .pdf-item { margin: 0.3rem 0; }
    a {
      color: #1574f6;
      text-decoration: none;
      font-size: 1.05rem;
    }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>

<h1>Yoav's Physics PDFs</h1>
<p>רשימת תיקיות וקבצים נטענת אוטומטית מהריפו.</p>

<div id="content">טוען…</div>

<script>
  const owner = "YoavsPhysicsNotes";
  const repo = "pdf-storage";

  async function getContents(path = "") {
    const url = `https://api.github.com/repos/${owner}/${repo}/contents/${path}`;
    const res = await fetch(url);
    if (!res.ok) return [];
    return await res.json();
  }

  function isPdf(file) {
    return file.type === "file" && file.name.toLowerCase().endsWith(".pdf");
  }

  function isDir(item) {
    return item.type === "dir";
  }

  async function load() {
    const container = document.getElementById("content");
    container.innerHTML = "";

    // שלב 1: קבל את כל האייטמים בשורש
    const rootItems = await getContents("");

    // שלב 2: קבצים PDF בשורש (במידה ויש)
    const rootPdfs = rootItems.filter(isPdf);
    if (rootPdfs.length > 0) {
      const h2 = document.createElement("h2");
      h2.textContent = "קבצים כלליים";
      container.appendChild(h2);

      rootPdfs.forEach(f => {
        const div = document.createElement("div");
        div.className = "pdf-item";

        const a = document.createElement("a");
        a.href = f.download_url;
        a.target = "_blank";
        a.textContent = f.name.replace(/\.pdf$/i, "");

        div.appendChild(a);
        container.appendChild(div);
      });
    }

    // שלב 3: מצא תיקיות
    const dirs = rootItems.filter(isDir);

    for (const dir of dirs) {
      const dirName = dir.name;
      const files = await getContents(dir.path);
      const pdfs = files.filter(isPdf);

      if (pdfs.length === 0) continue; // דלג על תיקיות ריקות

      const h2 = document.createElement("h2");
      h2.textContent = dirName;
      container.appendChild(h2);

      pdfs.forEach(f => {
        const div = document.createElement("div");
        div.className = "pdf-item";

        const a = document.createElement("a");
        a.href = f.download_url;
        a.target = "_blank";
        a.textContent = f.name.replace(/\.pdf$/i, "");

        div.appendChild(a);
        container.appendChild(div);
      });
    }

    if (!container.innerHTML.trim()) {
      container.textContent = "אין עדיין קבצים או תיקיות.";
    }
  }

  load();
</script>

</body>
</html>
